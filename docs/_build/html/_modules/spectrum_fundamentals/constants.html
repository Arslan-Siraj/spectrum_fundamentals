<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spectrum_fundamentals.constants &mdash; spectrum_fundamentals 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> spectrum_fundamentals
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">spec_fundamentals</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">spectrum_fundamentals</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>spectrum_fundamentals.constants</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for spectrum_fundamentals.constants</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#####################</span>
<span class="c1"># GENERAL CONSTANTS #</span>
<span class="c1">#####################</span>

<span class="n">SEQ_LEN</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Sequence length for prosit</span>
<span class="n">NUM_CHARGES_ONEHOT</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">MIN_CHARGE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MAX_CHARGE</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">6000</span>
<span class="n">VEC_LENGTH</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span>
<span class="p">)</span>  <span class="c1"># peptide of length 30 has 29 b and y-ions, each with charge 1+, 2+ and 3+, for a total of 174 fragments</span>

<span class="c1">#############</span>
<span class="c1"># ALPHABETS #</span>
<span class="c1">#############</span>

<span class="n">AA_ALPHABET</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
    <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;V&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s2">&quot;Y&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">TERMINAL_ALPHABET</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;[]-&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;-[]&quot;</span><span class="p">:</span> <span class="mi">31</span><span class="p">}</span>  <span class="c1"># unmodified n terminus  # unmodified c terminus</span>

<span class="n">ALPHABET_MODS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;M[UNIMOD:35]&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;C[UNIMOD:4]&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:737]&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:214]&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:730]&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;S[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
    <span class="s2">&quot;T[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
    <span class="s2">&quot;Y[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
    <span class="s2">&quot;S[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s2">&quot;T[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;Y[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:1]-&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="s2">&quot;K[UNIMOD:259]&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;R[UNIMOD:267]&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ALPHABET</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">AA_ALPHABET</span><span class="p">,</span> <span class="o">**</span><span class="n">ALPHABET_MODS</span><span class="p">,</span> <span class="o">**</span><span class="n">TERMINAL_ALPHABET</span><span class="p">}</span>

<span class="c1">######################</span>
<span class="c1"># MaxQuant constants #</span>
<span class="c1">######################</span>

<span class="n">MAXQUANT_VAR_MODS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;(ox)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(Oxidation (M))&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(tm)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_(tm)&quot;</span><span class="p">:</span> <span class="s2">&quot;_[UNIMOD:737]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K(tm)&quot;</span><span class="p">:</span> <span class="s2">&quot;K[UNIMOD:737]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(i4)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_(i4)&quot;</span><span class="p">:</span> <span class="s2">&quot;_[UNIMOD:214]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K(i4)&quot;</span><span class="p">:</span> <span class="s2">&quot;K[UNIMOD:214]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(i8)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_(i8)&quot;</span><span class="p">:</span> <span class="s2">&quot;_[UNIMOD:730]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K(i8)&quot;</span><span class="p">:</span> <span class="s2">&quot;K[UNIMOD:730]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(tmp)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;_(tmp)&quot;</span><span class="p">:</span> <span class="s2">&quot;_[UNIMOD:2016]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K(tmp)&quot;</span><span class="p">:</span> <span class="s2">&quot;K[UNIMOD:2016]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(ph)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(Phospho (STY))&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(de)&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:23]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;(Dehydrated (ST))&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:23]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;K(Lys8)&quot;</span><span class="p">:</span> <span class="s2">&quot;K[UNIMOD:259]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;R(Arg10)&quot;</span><span class="p">:</span> <span class="s2">&quot;R[UNIMOD:267]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;C(Carbamidomethyl (C))&quot;</span><span class="p">:</span> <span class="s2">&quot;C[UNIMOD:4]&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">MAXQUANT_NC_TERM</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;^_&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_$&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>

<span class="c1">####################</span>
<span class="c1"># MASS CALCULATION #</span>
<span class="c1">####################</span>

<span class="c1"># initialize other masses</span>
<span class="n">PARTICLE_MASSES</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;PROTON&quot;</span><span class="p">:</span> <span class="mf">1.007276467</span><span class="p">,</span> <span class="s2">&quot;ELECTRON&quot;</span><span class="p">:</span> <span class="mf">0.00054858</span><span class="p">}</span>

<span class="c1"># masses of different atoms</span>
<span class="n">ATOM_MASSES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">1.007825035</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span>
    <span class="s2">&quot;O&quot;</span><span class="p">:</span> <span class="mf">15.9949146</span><span class="p">,</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">14.003074</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">MASSES</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">PARTICLE_MASSES</span><span class="p">,</span> <span class="o">**</span><span class="n">ATOM_MASSES</span><span class="p">}</span>
<span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;N_TERMINUS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;C_TERMINUS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">]</span>


<span class="n">AA_MASSES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mf">71.037114</span><span class="p">,</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="mf">156.101111</span><span class="p">,</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="mf">114.042927</span><span class="p">,</span>
    <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="mf">115.026943</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mf">103.009185</span><span class="p">,</span>
    <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="mf">129.042593</span><span class="p">,</span>
    <span class="s2">&quot;Q&quot;</span><span class="p">:</span> <span class="mf">128.058578</span><span class="p">,</span>
    <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="mf">57.021464</span><span class="p">,</span>
    <span class="s2">&quot;H&quot;</span><span class="p">:</span> <span class="mf">137.058912</span><span class="p">,</span>
    <span class="s2">&quot;I&quot;</span><span class="p">:</span> <span class="mf">113.084064</span><span class="p">,</span>
    <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="mf">113.084064</span><span class="p">,</span>
    <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="mf">128.094963</span><span class="p">,</span>
    <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="mf">131.040485</span><span class="p">,</span>
    <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="mf">147.068414</span><span class="p">,</span>
    <span class="s2">&quot;P&quot;</span><span class="p">:</span> <span class="mf">97.052764</span><span class="p">,</span>
    <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="mf">87.032028</span><span class="p">,</span>
    <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="mf">101.047679</span><span class="p">,</span>
    <span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="mf">150.95363</span><span class="p">,</span>
    <span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="mf">186.079313</span><span class="p">,</span>
    <span class="s2">&quot;Y&quot;</span><span class="p">:</span> <span class="mf">163.063329</span><span class="p">,</span>
    <span class="s2">&quot;V&quot;</span><span class="p">:</span> <span class="mf">99.068414</span><span class="p">,</span>
    <span class="s2">&quot;[]-&quot;</span><span class="p">:</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;N_TERMINUS&quot;</span><span class="p">],</span>
    <span class="s2">&quot;-[]&quot;</span><span class="p">:</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;C_TERMINUS&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">MOD_MASSES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">:</span> <span class="mf">229.162932</span><span class="p">,</span>  <span class="c1"># TMT_6</span>
    <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="mf">304.207146</span><span class="p">,</span>  <span class="c1"># TMT_PRO</span>
    <span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">:</span> <span class="mf">144.102063</span><span class="p">,</span>  <span class="c1"># iTRAQ4</span>
    <span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">:</span> <span class="mf">304.205360</span><span class="p">,</span>  <span class="c1"># iTRAQ8</span>
    <span class="s2">&quot;[UNIMOD:259]&quot;</span><span class="p">:</span> <span class="mf">8.014199</span><span class="p">,</span>  <span class="c1"># SILAC Lysine</span>
    <span class="s2">&quot;[UNIMOD:267]&quot;</span><span class="p">:</span> <span class="mf">10.008269</span><span class="p">,</span>  <span class="c1"># SILAC Arginine</span>
    <span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="mf">79.966331</span><span class="p">,</span>  <span class="c1"># Phospho</span>
    <span class="s2">&quot;[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">18.010565</span><span class="p">,</span>  <span class="c1"># Dehydration after phospho loss</span>
    <span class="s2">&quot;[UNIMOD:4]&quot;</span><span class="p">:</span> <span class="mf">57.02146</span><span class="p">,</span>  <span class="c1"># Carbamidomethyl</span>
    <span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">:</span> <span class="mf">15.9949146</span><span class="p">,</span>  <span class="c1"># Oxidation</span>
    <span class="s2">&quot;[UNIMOD:1]&quot;</span><span class="p">:</span> <span class="mf">42.010565</span><span class="p">,</span>  <span class="c1"># Acetylation</span>
<span class="p">}</span>

<span class="c1"># these are only used for prosit_grpc, oktoberfest uses the masses from MOD_MASSES</span>
<span class="n">AA_MOD_MASSES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;K[UNIMOD:737]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;M[UNIMOD:35]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;C[UNIMOD:4]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:4]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;K[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;K[UNIMOD:214]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;K[UNIMOD:730]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;S[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;T[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Y[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;S[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">],</span>  <span class="c1"># + MOD_MASSES[&#39;[UNIMOD:23]&#39;],</span>
    <span class="s2">&quot;T[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>  <span class="c1"># + MOD_MASSES[&#39;[UNIMOD:23]&#39;],</span>
    <span class="s2">&quot;Y[UNIMOD:23]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>  <span class="c1"># + MOD_MASSES[&#39;[UNIMOD:23]&#39;],</span>
    <span class="s2">&quot;[UNIMOD:1]-&quot;</span><span class="p">:</span> <span class="n">MASSES</span><span class="p">[</span><span class="s2">&quot;N_TERMINUS&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">MOD_MASSES</span><span class="p">[</span><span class="s2">&quot;[UNIMOD:1]&quot;</span><span class="p">],</span>
    <span class="s2">&quot;K[UNIMOD:259]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span>
        <span class="s2">&quot;K&quot;</span>
    <span class="p">],</span>  <span class="c1"># + MOD_MASSES[&#39;[UNIMOD:259]&#39;],#we need a different way of encoding mods on AA so it wouldn&#39;t have same encoding</span>
    <span class="c1"># to make vecMZ work</span>
    <span class="s2">&quot;R[UNIMOD:267]&quot;</span><span class="p">:</span> <span class="n">AA_MASSES</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">],</span>  <span class="c1"># + MOD_MASSES[&#39;[UNIMOD:267]&#39;]</span>
<span class="p">}</span>

<span class="n">AA_MOD</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">AA_MASSES</span><span class="p">,</span> <span class="o">**</span><span class="n">AA_MOD_MASSES</span><span class="p">}</span>

<span class="c1">#######################################</span>
<span class="c1"># HELPERS FOR FRAGMENT MZ CALCULATION #</span>
<span class="c1">#######################################</span>

<span class="c1"># Array containing masses --- at index one is mass for A, etc.</span>
<span class="c1"># these are only used for prosit_grpc, oktoberfest uses the masses from MOD_MASSES</span>
<span class="n">VEC_MZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">ALPHABET</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ALPHABET</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">VEC_MZ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">AA_MOD</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>

<span class="c1"># small positive intensity to distinguish invalid ion (=0) from missing peak (=EPSILON)</span>
<span class="n">EPSILON</span> <span class="o">=</span> <span class="mf">1e-7</span>

<span class="n">B_ION_MASK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Y_ION_MASK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">SINGLE_CHARGED_MASK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">DOUBLE_CHARGED_MASK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">TRIPLE_CHARGED_MASK</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">SEQ_LEN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">SHARED_DATA_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RAW_FILE&quot;</span><span class="p">,</span> <span class="s2">&quot;SCAN_NUMBER&quot;</span><span class="p">]</span>
<span class="n">META_DATA_ONLY_COLUMNS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;MODIFIED_SEQUENCE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PRECURSOR_CHARGE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FRAGMENTATION&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MASS_ANALYZER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MASS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SCAN_EVENT_NUMBER&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PRECURSOR_MASS_EXP&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SCORE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;REVERSE&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RETENTION_TIME&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">META_DATA_COLUMNS</span> <span class="o">=</span> <span class="n">SHARED_DATA_COLUMNS</span> <span class="o">+</span> <span class="n">META_DATA_ONLY_COLUMNS</span>
<span class="n">MZML_ONLY_DATA_COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;INTENSITIES&quot;</span><span class="p">,</span> <span class="s2">&quot;MZ&quot;</span><span class="p">,</span> <span class="s2">&quot;MZ_RANGE&quot;</span><span class="p">]</span>
<span class="n">MZML_DATA_COLUMNS</span> <span class="o">=</span> <span class="n">SHARED_DATA_COLUMNS</span> <span class="o">+</span> <span class="n">MZML_ONLY_DATA_COLUMNS</span>

<span class="n">TMT_MODS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;tmt&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tmtpro&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;itraq4&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;itraq8&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tmt_msa&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tmtpro_msa&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;itraq4_msa&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;itraq8_msa&quot;</span><span class="p">:</span> <span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Used for MSP spectral library format</span>
<span class="n">MOD_NAMES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">:</span> <span class="s2">&quot;TMT_6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="s2">&quot;TMT_Pro&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="s2">&quot;Phospho&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:4]&quot;</span><span class="p">:</span> <span class="s2">&quot;Carbamidomethyl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">:</span> <span class="s2">&quot;Oxidation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:214]&quot;</span><span class="p">:</span> <span class="s2">&quot;iTRAQ4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:730]&quot;</span><span class="p">:</span> <span class="s2">&quot;iTRAQ8&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Used for MSP spectral library format</span>
<span class="n">SPECTRONAUT_MODS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;[UNIMOD:737]&quot;</span><span class="p">:</span> <span class="s2">&quot;[TMT_6]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:2016]&quot;</span><span class="p">:</span> <span class="s2">&quot;[TMT_Pro]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:21]&quot;</span><span class="p">:</span> <span class="s2">&quot;[Phospho]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:4]&quot;</span><span class="p">:</span> <span class="s2">&quot;[Carbamidomethyl (C)]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;[UNIMOD:35]&quot;</span><span class="p">:</span> <span class="s2">&quot;[Oxidation (O)]&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">FRAGMENTATION_ENCODING</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;HCD&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;CID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1">############################</span>
<span class="c1"># GENERATION OF ANNOTATION #</span>
<span class="c1">############################</span>

<span class="n">IONS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]</span>  <span class="c1"># limited to single character unicode string when array is created</span>
<span class="n">CHARGES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># limited to uint8 (0-255) when array is created</span>
<span class="n">POSITIONS</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>  <span class="c1"># fragment numbers 1-29 -- limited to uint8 (0-255) when array is created</span>

<span class="n">ANNOTATION_FRAGMENT_TYPE</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ANNOTATION_FRAGMENT_CHARGE</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ANNOTATION_FRAGMENT_NUMBER</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">POSITIONS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ion</span> <span class="ow">in</span> <span class="n">IONS</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">charge</span> <span class="ow">in</span> <span class="n">CHARGES</span><span class="p">:</span>
            <span class="n">ANNOTATION_FRAGMENT_TYPE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ion</span><span class="p">)</span>
            <span class="n">ANNOTATION_FRAGMENT_CHARGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
            <span class="n">ANNOTATION_FRAGMENT_NUMBER</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="n">ANNOTATION</span> <span class="o">=</span> <span class="p">[</span><span class="n">ANNOTATION_FRAGMENT_TYPE</span><span class="p">,</span> <span class="n">ANNOTATION_FRAGMENT_CHARGE</span><span class="p">,</span> <span class="n">ANNOTATION_FRAGMENT_NUMBER</span><span class="p">]</span>


<span class="c1">########################</span>
<span class="c1"># RESCORING PARAMETERS #</span>
<span class="c1">########################</span>


<div class="viewcode-block" id="RescoreType"><a class="viewcode-back" href="../../spectrum_fundamentals.html#spectrum_fundamentals.constants.RescoreType">[docs]</a><span class="k">class</span> <span class="nc">RescoreType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for rescoring types.&quot;&quot;&quot;</span>

    <span class="n">PROSIT</span> <span class="o">=</span> <span class="s2">&quot;prosit&quot;</span>
    <span class="n">ANDROMEDA</span> <span class="o">=</span> <span class="s2">&quot;andromeda&quot;</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Victor-George Giurcoiu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>